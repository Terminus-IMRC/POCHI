# 手順書の書式

## 概要
本ドキュメントでは POCHI を動かすプログラムに与える手順書の書式を述べる。

## 手順書の書式

### 概要
* 本手順書は複数のエントリーから成るテキストファイルである。
* 1つのエントリーはスペースで区切られた3カラム1行から成る。
* エントリーでは、POCHI を傾ける方向・角度とその動作を行い始めるタイミングを指定する。

### エントリーの書式
```
time direction degrees
```
プログラムの実行開始から _time_ ミリ秒後に _direction_ の方向に _degrees_ °傾け始める。
* _time_ : 傾け始めるタイミングの指定 (単位:ミリ秒 (10^-3 秒))
   * タイミングには絶対時間もしくは相対時間を指定することができる。
   * 相対時間の場合、先頭に + を付ける。
* _direction_ : POCHI を傾ける方向の指定 (値:0 または 1)
   * 0 を指定すると前後方向、1 を指定すると左右方向に傾ける。
* _degrees_ : POCHI を傾ける角度の指定 (値域:-90 以上 90 以下) (単位:°)
   * 前後・左右ともにプログラム実行開始時の角度を0°とする。
   * 前・右方向への角度を正とする。
   * 値が正または0の場合、値の先頭に + を付けることができる。
   * _direction_ に0を指定し _degrees_ に0未満の数を指定した場合、POCHI は後ろに傾く。
   * _direction_ に0を指定し _degrees_ に0より大きい数を指定した場合、POCHI は前に傾く。
   * _direction_ に1を指定し _degrees_ に0未満の数を指定した場合、POCHI は左に傾く。
   * _direction_ に1を指定し _degrees_ に0より大きい数を指定した場合、POCHI は右に傾く。

### エントリーの例
プログラム実行開始から1000ミリ秒後に右45°の位置まで傾け始める:

``` 1000 1 45 ```

プログラム実行開始から0ミリ秒後に後ろ90°の位置まで傾け始める:

``` 0 0 -90 ```

### 手順書の例
プログラム実行開始から100ミリ秒後に右45°の位置まで傾け始め、プログラム実行開始から2000ミリ秒後に左30°の位置まで傾け始める:

```
100 1 45
2000 1 -30
```

プログラム実行開始から100ミリ秒後に右45°の位置まで傾け始め、その500ミリ秒後 (つまりプログラム実行開始から600ミリ秒後) に後ろ20°の位置まで傾け始める:

```
100 1 45
+500 0 -20
```

プログラム実行開始から100ミリ秒後に前45°右20°の位置まで傾け始め、その1000ミリ秒後 (つまりプログラム実行開始から1100ミリ秒後) に前後0°左右0°の位置 (初期位置) まで傾け始める:

```
100 0 45
100 1 20
+1000 0 0
+0 1 0
```

### この書式に至った経緯
2015年6月1日現在、POCHI の回転機構が完成していないので、回転信号を与える時間によってどの程度回転するのか分からない。
そのため、実際の回転の程度に依存せずに動画に合わせた回転の程度を指定できるような書式にする必要があった。

回転する目標の角度を指定する書式にすることで、手順書を修正せずにプログラムを修正するだけで POCHI の回転機構の仕様変更に対応できるようになった。

### FAQ
```
Q. 前のエントリーで指定した回転が完了していない時に次のエントリーを指定するとどうなるか。
A. 前のエントリーで指定した回転はキャンセルされ、次のエントリーが実行される。
```

```
Q. 指定するタイミングの精度はどのくらいか。
A. タイミングの精度は30ミリ秒以下である。
本プログラムは実行開始時点から経過した時間をできるだけ頻繁に取得し、その時間が指定された時間と同じかそれを過ぎているならば指定された動作を実行開始する。
コンピュータの処理性能の問題により、30ミリ秒未満のタイミングを指定するとその動作が前後の動作のタイミングと被ってしまい、うまく動かない可能性がある。
```